(function(b,c,e,d){var a={init:function(h,g,i){if(!h||h.length==0){return}var f=h.length;this.picData=h;this.curIndex=g||0;this.picCount=f;var i=i||{};this.maxWidth=i.maxWidth||900;this.maxHeight=i.maxHeight||600;this.generateHtml()},generateHtml:function(){var f=this.dialog=c("#mvBigPicPart"),g=this;if(!f[0]){str=c.format('<div id="mvBigPicPart" class="show_poster"><a href="javascript:;" class="close"></a><img src="{0}"  alt="" id="mvBigPic" /><span class="show_loading" style="display:none;"></span><a href="javascript:;" class="show_left" hidefocus="true"><b {1}></b></a><a href="javascript:;" class="show_right" hidefocus="true"><b {2}></b></a><span class="span_ie6"></span></div>',this.picData[this.curIndex],this.curIndex<=0?'style="display:none;"':"",this.curIndex>=this.picCount-1?'style="display:none;"':"");c(document.body).append(str);this.bindDomEvent();this.showPic();this.showLayout()}else{c("#mvBigPic")[0].src="";this.showPic();f.show();this.showLayout()}c(document).bind("keydown",this.docKeydownEv)},docKeydownEv:function(f){a.keycodeHandler(f)},showLayout:function(){var g=c("#mvBigPicPart").css("z-index")-1||9999,f=function(h){return Math.max(document.documentElement[h],document.body[h])};c(document.body).append(c.format('<div class="iDialogLayout" style="z-index: {0}; width:{1}px; height:{2}px" ></div>',g,f("scrollWidth"),f("scrollHeight")));c(b).resize(function(){c(".iDialogLayout").css({width:f("scrollWidth"),height:f("scrollHeight")})})},hideLayout:function(){c(".iDialogLayout").remove();c(b).unbind("resize")},bindDomEvent:function(){var f=this.dialog=c("#mvBigPicPart"),g=a;f.find(".close").click(c.proxy(this.closeBigPic,this)).disableDarg();f.find(".show_left").click(c.proxy(this.prevPic,this)).disableDarg();f.find(".show_right").click(c.proxy(this.nextPic,this)).disableDarg()},closeBigPic:function(){c("#mvBigPicPart").hide();this.hideLayout();c(document).unbind("keydown",this.docKeydownEv)},prevPic:function(){this.showPic(this.curIndex--)},nextPic:function(){this.showPic(this.curIndex++)},showPic:function(){var j=c("#mvBigPic");if(this.curIndex<0){this.curIndex=0;return}if(this.curIndex>this.picCount-1){this.curIndex=this.picCount-1;return}if(this.curIndex==0){this.dialog.find(".show_left b").hide()}else{this.dialog.find(".show_left b").show()}if(this.curIndex==this.picCount-1){this.dialog.find(".show_right b").hide()}else{this.dialog.find(".show_right b").show()}var g=new Image(),f,i,k=this;g.onload=function(){var l=g.width,m=g.height;if(l>k.maxWidth){l=k.maxWidth;m=l*g.height/g.width}if(m>k.maxHeight){m=k.maxHeight;l=m*g.width/g.height}k.dialog.find(".show_loading")[0].style.display="none";j[0].src=k.picData[k.curIndex];j.css({width:l+"px",height:m+"px"});g=null};this.dialog.find(".show_loading")[0].style.display="inline-block";g.src=this.picData[this.curIndex]},keycodeHandler:function(g){var f=g.keyCode;switch(f){case 38:case 37:this.prevPic();g.preventDefault();break;case 40:case 39:this.nextPic();g.preventDefault();break;case 27:this.closeBigPic();break}}};e.showBigMvpic=function(g,f,h){a.init(g,f,h)}})(window,jQuery,Core);